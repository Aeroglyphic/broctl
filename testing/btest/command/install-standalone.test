# Test that the install command creates necessary directories and files.
#
# @TEST-EXEC: bash -ex %INPUT
# @TEST-EXEC: TEST_DIFF_CANONIFIER=$SCRIPTS/diff-remove-abspath btest-diff out

. broctl-test-setup

test ! -e $BROCTL_INSTALL_PREFIX/logs/current
test ! -e $BROCTL_INSTALL_PREFIX/spool/broctl-config.sh
test ! -e $BROCTL_INSTALL_PREFIX/spool/broctl.dat
test ! -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/site/local.bro
test ! -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/broctl-config.bro
test ! -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/local-networks.bro
test ! -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/standalone-layout.bro

broctl install 2> out

test -h $BROCTL_INSTALL_PREFIX/logs/current
test -e $BROCTL_INSTALL_PREFIX/spool/broctl-config.sh
test -e $BROCTL_INSTALL_PREFIX/spool/broctl.dat
test -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/site/local.bro
test -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/broctl-config.bro
test -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/local-networks.bro
test -e $BROCTL_INSTALL_PREFIX/spool/installed-scripts-do-not-touch/auto/standalone-layout.bro

